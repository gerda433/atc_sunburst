---
title: "Minimal Quarto Shiny + Plotly Example"
format: html
server: shiny
---

## Shiny Documents

This Quarto document is made interactive using Shiny. Interactive documents allow readers to modify parameters and see the results immediately. Learn more about Shiny interactive documents at <https://quarto.org/docs/interactive/shiny/>.


```{r}
# Load required libraries
library(shiny)
library(plotly)
library(dplyr)
library(tidyverse)
```

```{r}
# Example toy hierarchy data
hierarchy <- tibble(
  ids = c("A", "B", "A1", "A2", "B1"),
  labels = c("Group A", "Group B", "Sub A1", "Sub A2", "Sub B1"),
  parents = c("", "", "A", "A", "B"),
  values = c(10, 20, 5, 5, 20)
)
```

## Inputs and Outputs
You can embed Shiny inputs and outputs in your document. Outputs are automatically updated whenever inputs change. This demonstrates how a standard R plot can be made interactive:

```{r}
# Simple Shiny input
textInput("txt", "Enter label filter (try A or B):", "")
plotOutput("sunburst")
```


```{r}
#| context: server



output$sunburst <- renderPlotly({
  # Filter if user typed something
  filtered <- hierarchy %>%
    filter(labels %>% grepl(input$txt, ., ignore.case = TRUE) | input$txt == "")

  # Build plotly sunburst
  plot_ly(
    filtered,
    ids = ~ids,
    labels = ~labels,
    parents = ~parents,
    values = ~values,
    type = "sunburst",
    branchvalues = "total"
  )
})
```
